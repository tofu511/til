# ビッグデータのパイプライン
## ワークフロー管理
- 企業内の定型的な業務プロセス(申請、承認、報告など)のような、決まった仕事を円滑に進めるための仕組みを一般にワークフロー管理(workflow management)と呼ぶ
- ワークフロー管理ツールの主な役割
  - 定期的にタスクを実行する
  - 異常を検知してその解決を手助けする

### ワークフロー管理ツールとタスク
- データパイプラインの実行過程では、データを次から次へと移動しながら決まった処理を繰り返す。このとき実行される個々の処理をタスクと呼ぶ

### 基本機能とビッグデータで求められる機能
- ワークフロー管理ツールは主として以下のような機能を提供する
  - タスクを定期的なスケジュールで実行し、その結果を通知する
  - タスク間の依存関係を定めて、決められた順にもれなく実行する
  - タスクの実行結果を保持し、エラー発生時には再実行できるようにする

## エラーからリカバリー方法を先に考える
### リカバリーとフローの再実行
- エラーには無数の可能性があるので、ワークフロー管理では基本的にエラーから自動回復できるものとは考えない
- 代わりに手作業によるリカバリーを前提としてタスクを設計する
  - 失敗したタスクは全て記録して、それを後から再実行できるようにする

## 冪等な操作としてタスクを記述する
- リカバリーの前提として再実行の安全性を忘れてはいけない
- 各タスクの原則は「最後まで成功」もしくは「失敗して何も残らない」のどちらか

### 冪等な操作
- より確実なのは「同じタスクを何度実行しても同じ結果になる」こと

### アトミックな追記
- 複雑なフローで1つのテーブルになんどもデータを書き込みたいときは、中間テーブル作成してから最後に目的にテーブルに追記するのが安全
