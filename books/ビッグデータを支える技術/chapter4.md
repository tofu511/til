# ビッグデータの蓄積
### オブジェクトストレージとデータインジェスション
- 集めたデータを加工することで、集計効率の高い分散ストレージを作る一連のプロセスをデータインジェスション(data ingestion)と呼ぶ
  - データ収集、構造化データの作成、分散ストレージへの長期的な保存などが含まれる

### バルク型のデータ転送
- バルク型の方式ではデータベースやファイルサーバー、Webサービスなどからまとめてデータを取り出す
- 一度に大量データを転送すべきではない(何TBとか)
- データ転送の信頼性が重要な場合は、可能な限りバルク型のツールを使うべき
  - バルク型はストリーミング型と違いやり直しがきく
- バルク型のデータ転送はワークフロー管理ツールとの相性が良い

### ストリーミング型のメッセージ配送
- 今データが発生して、まだどこにも保存されていないデータではバルク型ツールで集めることができない
  - Webブラウザ、モバイルアプリ、デバイスなど

#### Webブラウザからのメッセージ配送
- Webアプリではサーバ上でデータを貯めてからまとめて送ることが多い
  - こういったケースではfluentdやlogstashなどのサーバ常駐型のログ収集ソフトウェアがよく使われる
- JSを使って直接メッセージを送ることもある(Webイベントトラッキング)

### メッセージブローカ
- 大量のメッセージを安定して受け取るためには、頻繁な書き込みへの性能が極めて高く、しかも必要に応じていくらでも性能を上げられるストレージが必要
- ビッグデータのメッセージ配送システムではデータを一時的に備える中間層が設置され、これをメッセージブローカ(message broker)と呼ぶ
  - Apache Kafka, Amazon Kinesis, Cloud Pub/Sub など
- push型とpull型があり、プッシュするものをプロデューサ、プルするものをコンシューマと呼ぶ

### メッセージ配送を確実に行うのは難しい
- 配送をどのように行うかはシステムによって異なる
  - at most once
    - メッセージは一度しか送られない。ただし途中で失敗して消える可能性がある（欠損する）
  - at least once
    - メッセージは間違いなく届けられる。ただし同じものが何度も届く可能性がある（重複する）
  - exactly once
    - メッセージは欠損も重複もなく一度だけ届けられる
- ほとんどのメッセージ配送システムはat least onceを保証する一方で、重複排除は利用者に任されている
- 重複があっても問題にならないようなシステムを設計することが推奨される
